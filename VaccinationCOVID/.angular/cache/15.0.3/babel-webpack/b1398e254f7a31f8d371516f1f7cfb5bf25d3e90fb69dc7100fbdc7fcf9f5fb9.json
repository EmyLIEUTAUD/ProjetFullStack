{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nexport let EnvoiFormulaireService = /*#__PURE__*/(() => {\n  class EnvoiFormulaireService {\n    constructor(httpClient, router) {\n      this.httpClient = httpClient;\n      this.router = router;\n      this.word = '';\n      this.infos = '';\n      this.flag = false;\n    }\n    /*   saveRdv(centre: ChoixCentre,prenom: string,nom: string,mail: string,dateRdv: string){\r\n        this.personne.prenom = prenom;\r\n        this.personne.nom = nom;\r\n        this.personne.mail = mail;\r\n        console.log(\"personne\"+this.personne);\r\n    \r\n        const inscription = JSON.stringify(centre.gid)+JSON.stringify(this.personne)+JSON.stringify(dateRdv);\r\n        console.log(\"test\"+inscription);\r\n    \r\n        this.httpClient.post(\"public/inscription\",inscription);\r\n        console.log(inscription);\r\n      } */\n    saveRdv(centre, prenom, nom, mail, date_reservation) {\n      const personne = {\n        prenom: prenom,\n        nom: nom,\n        mail: mail\n      };\n      const inscription = {\n        centre: centre,\n        personne: personne,\n        date_reservation: date_reservation\n      };\n      console.log(\"test : \", inscription);\n      /*this.httpClient.post<string>(\"public/inscription\",inscription).subscribe(\r\n        data => {\r\n           console.log(\"succès\")\r\n           console.log(data)\r\n        }\r\n      );*/\n      console.log(\"infos :\");\n      let temps;\n      this.httpClient.post('/public/inscription/', inscription, {\n        observe: 'response'\n      }).subscribe({\n        next: resp => {\n          console.log(\"succès\");\n          console.log(resp);\n          const keys = resp.headers.keys();\n          console.log(keys);\n          const nbToken = resp.headers.get('X-Rate-Limit-Remaining');\n          this.infos = `${nbToken} tokens restant`;\n          this.flag = true;\n        },\n        error: err => {\n          console.log(\"C'est une erreur\");\n          //this.isNotSuccessful = true;\n          console.error(err);\n          const keys = err.headers.keys();\n          console.log(keys);\n          temps = err.headers.get('X-Rate-Limit-Retry-After-Seconds');\n          this.infos = `Ressayer après ${temps} secondes`;\n          this.flag = false;\n        }\n      });\n      if (this.flag) {\n        console.log(\"flag is true\");\n        return true;\n      }\n      console.log(\"j'ai fini de contacter /public/inscription\");\n      return false;\n      /*return this.httpClient.post<String>(\"public/inscription\",inscription1);\r\n      console.log(\"test2\",inscription);*/\n    }\n  }\n\n  EnvoiFormulaireService.ɵfac = function EnvoiFormulaireService_Factory(t) {\n    return new (t || EnvoiFormulaireService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.Router));\n  };\n  EnvoiFormulaireService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: EnvoiFormulaireService,\n    factory: EnvoiFormulaireService.ɵfac,\n    providedIn: 'root'\n  });\n  return EnvoiFormulaireService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}